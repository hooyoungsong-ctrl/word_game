<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Word Battle - Final</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #8e44ad;
            --danger: #e74c3c;
            --success: #2ecc71;
            --bg: #f0f4f8;
        }
        body {
            font-family: 'Jua', 'Malgun Gothic', sans-serif;
            background-color: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }
        .game-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            position: relative;
            height: 80vh; /* ë†’ì´ ê³ ì •í•˜ì—¬ ëª¨ë‹¬ ìŠ¤í¬ë¡¤ í™•ë³´ */
            display: flex;
            flex-direction: column;
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 10px;
            flex-shrink: 0;
        }
        .score-box { font-size: 1.1rem; font-weight: bold; color: #555; }
        .group-badge {
            background: var(--secondary); color: white; padding: 5px 15px;
            border-radius: 15px; font-size: 0.9rem; font-weight: bold;
        }

        .battle-area {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; padding: 0 20px; height: 120px;
            flex-shrink: 0;
        }
        .character { font-size: 4rem; transition: transform 0.2s; cursor: default; }
        .hp-bar-container {
            width: 80px; height: 10px; background: #ddd;
            border-radius: 5px; margin-top: 5px; overflow: hidden;
        }
        .hp-bar { height: 100%; transition: width 0.3s; }
        .player-hp { background: var(--success); }
        .monster-hp { background: var(--danger); }

        .question-box {
            background: #eef2f5; padding: 20px; border-radius: 15px; margin-bottom: 15px;
            min-height: 80px; display: flex; flex-direction: column; justify-content: center;
            flex-shrink: 0;
        }
        .word-display {
            font-size: 2.2rem; font-weight: bold; color: #333; margin-bottom: 5px;
        }
        .stage-info { color: #7f8c8d; font-size: 0.9rem; }

        .options-grid { 
            display: flex; flex-direction: column; gap: 8px; 
            flex-grow: 1; /* ë‚¨ì€ ê³µê°„ ì±„ìš°ê¸° */
            justify-content: center;
        }
        .option-btn {
            background: white; border: 2px solid #ddd; padding: 12px;
            font-size: 1.1rem; border-radius: 12px; cursor: pointer; transition: all 0.1s;
        }
        .option-btn:hover:not(:disabled) { background: #f9f9f9; border-color: var(--primary); }
        .option-btn:active:not(:disabled) { transform: scale(0.98); }
        
        .btn-correct { background-color: var(--success) !important; color: white !important; border-color: var(--success) !important; }
        .btn-wrong { background-color: var(--danger) !important; color: white !important; border-color: var(--danger) !important; }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake { animation: shake 0.5s; }
        .hit { filter: brightness(0.5) sepia(1) hue-rotate(-50deg) saturate(5); }

        .modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.98);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-radius: 20px; z-index: 20;
            padding: 20px; box-sizing: border-box;
        }
        .modal h2 { font-size: 2rem; margin-bottom: 10px; color: #333; }
        .start-btn, .restart-btn {
            padding: 15px 40px; background: var(--primary); color: white;
            border: none; border-radius: 50px; font-size: 1.5rem;
            cursor: pointer; box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
            transition: transform 0.2s; margin-top: 15px;
        }
        .start-btn:hover, .restart-btn:hover { transform: scale(1.05); }

        /* ì˜¤ë‹µ ë…¸íŠ¸ ìŠ¤íƒ€ì¼ */
        .wrong-note-container {
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin: 15px 0;
            padding: 10px;
            text-align: left;
        }
        .wrong-item {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #eee;
            padding: 5px 0;
            font-size: 0.95rem;
        }
        .wrong-item:last-child { border-bottom: none; }
        .wrong-en { color: #e74c3c; font-weight: bold; }
        .wrong-ko { color: #555; }
        .note-title { font-size: 1rem; color: #7f8c8d; margin-bottom: 5px; }

        /* ë‹¨ì–´ ê·¸ë£¹ ë³€ê²½ ì•Œë¦¼ íš¨ê³¼ */
        #group-notification {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8); color: #fff; padding: 20px 40px;
            border-radius: 10px; font-size: 1.5rem; z-index: 15;
            display: none; animation: popIn 0.5s; text-align: center;
            width: 80%;
        }
        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

<div class="game-container">
    <audio id="bgm" loop>
        <source src="https://codeskulptor-demos.commondatastorage.googleapis.com/pang/paza-moduless.mp3" type="audio/mp3">
    </audio>

    <div id="start-modal" class="modal">
        <h2>ì˜ì–´ ë‹¨ì–´ ë°°í‹€</h2>
        <p>500ë‹¨ì–´ ë§ˆìŠ¤í„°ì— ë„ì „í•˜ì„¸ìš”!</p>
        <button class="start-btn" onclick="startGame()">âš”ï¸ ê²Œì„ ì‹œì‘</button>
    </div>

    <div id="group-notification">
        <div style="color:#f1c40f">â˜… LEVEL UP â˜…</div>
        <div id="group-msg" style="font-size:1rem; margin-top:5px;">ìƒˆë¡œìš´ ë‹¨ì–´ ê·¸ë£¹ì´ ë“±ì¥í•©ë‹ˆë‹¤!</div>
    </div>

    <div class="stats-header">
        <div class="score-box">Score: <span id="score">0</span></div>
        <div class="score-box">Stage: <span id="stage">1</span></div>
        <div class="group-badge" id="group-badge">Group 1</div>
    </div>

    <div class="battle-area">
        <div>
            <div id="player" class="character">ğŸ§™â€â™‚ï¸</div>
            <div class="hp-bar-container"><div id="player-hp-bar" class="hp-bar player-hp" style="width: 100%"></div></div>
        </div>
        <div>
            <div id="monster" class="character">ğŸ‘¾</div>
            <div class="hp-bar-container"><div id="monster-hp-bar" class="hp-bar monster-hp" style="width: 100%"></div></div>
        </div>
    </div>

    <div class="question-box">
        <div class="stage-info" id="stage-info">Lv.3 Essential Words</div>
        <div id="word-display" class="word-display">Ready?</div>
    </div>

    <div id="options-container" class="options-grid"></div>

    <div id="game-modal" class="modal" style="display: none;">
        <h2 id="modal-title">Game Over!</h2>
        <p id="modal-score">Final Score: 0</p>
        
        <div class="note-title">ğŸ“ ì˜¤ë‹µ ë…¸íŠ¸ (Review)</div>
        <div id="wrong-answers-list" class="wrong-note-container">
            </div>

        <button class="restart-btn" onclick="goToTitle()">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
    </div>
</div>

<script>
    // --- 1. Sound System ---
    let audioCtx;
    function initAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const bgm = document.getElementById('bgm');
        bgm.volume = 0.2;
        bgm.play().catch(e => console.log("BGM play failed:", e));
    }
    function playWinSound() {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.type = 'sine';
        const now = audioCtx.currentTime;
        osc.frequency.setValueAtTime(523.25, now); 
        osc.frequency.setValueAtTime(659.25, now + 0.1);
        osc.frequency.setValueAtTime(783.99, now + 0.2);
        gain.gain.setValueAtTime(0.2, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.6);
        osc.start(now); osc.stop(now + 0.6);
    }
    function playLoseSound() {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.type = 'sawtooth';
        const now = audioCtx.currentTime;
        osc.frequency.setValueAtTime(150, now);
        osc.frequency.linearRampToValueAtTime(100, now + 0.3);
        gain.gain.setValueAtTime(0.2, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.3);
        osc.start(now); osc.stop(now + 0.3);
    }

    // --- 2. Game Data (500 Words Full Set) ---
    // ê°€ì§œ ë°ì´í„° ìƒì„± ì½”ë“œë¥¼ ì‚­ì œí•˜ê³ , ì „ì²´ 500ê°œ ë°ì´í„°ë¥¼ ì±„ì›ë‹ˆë‹¤.
    const wordDatabase = [
        // --- Group 1: Grade 3 Essential ---
        { en: "Ability", ko: "ëŠ¥ë ¥" }, { en: "Absorb", ko: "í¡ìˆ˜í•˜ë‹¤" }, { en: "Accuse", ko: "ë¹„ë‚œí•˜ë‹¤" },
        { en: "Act", ko: "í–‰ë™í•˜ë‹¤" }, { en: "Active", ko: "í™œë™ì ì¸" }, { en: "Actual", ko: "ì‹¤ì œì˜" },
        { en: "Adopt", ko: "ì±„íƒí•˜ë‹¤" }, { en: "Advantage", ko: "ì¥ì " }, { en: "Advice", ko: "ì¡°ì–¸" },
        { en: "Agree", ko: "ë™ì˜í•˜ë‹¤" }, { en: "Alert", ko: "ì•Œë¦¬ë‹¤" }, { en: "Amaze", ko: "ë†€ë¼ê²Œ í•˜ë‹¤" },
        { en: "Ambition", ko: "ì•¼ë§" }, { en: "Ancient", ko: "ê³ ëŒ€ì˜" }, { en: "Announce", ko: "ë°œí‘œí•˜ë‹¤" },
        { en: "Applaud", ko: "ë°•ìˆ˜ì¹˜ë‹¤" }, { en: "Approach", ko: "ì ‘ê·¼í•˜ë‹¤" }, { en: "Approve", ko: "ìŠ¹ì¸í•˜ë‹¤" },
        { en: "Argue", ko: "ë…¼ìŸí•˜ë‹¤" }, { en: "Arrange", ko: "ì¤€ë¹„í•˜ë‹¤" }, { en: "Arrest", ko: "ì²´í¬í•˜ë‹¤" },
        { en: "Artist", ko: "ì˜ˆìˆ ê°€" }, { en: "Ashamed", ko: "ë¶€ë„ëŸ¬ìš´" }, { en: "Assist", ko: "ë•ë‹¤" },
        { en: "Attack", ko: "ê³µê²©í•˜ë‹¤" }, { en: "Attempt", ko: "ì‹œë„í•˜ë‹¤" }, { en: "Attention", ko: "ì£¼ì˜" },
        { en: "Attract", ko: "ëŒë‹¤" }, { en: "Avoid", ko: "í”¼í•˜ë‹¤" }, { en: "Awake", ko: "ê¹¨ì–´ìˆëŠ”" },
        { en: "Balance", ko: "ê· í˜•" }, { en: "Bare", ko: "ë²Œê±°ë²—ì€" }, { en: "Barrier", ko: "ì¥ë²½" },
        { en: "Base", ko: "ê¸°ì´ˆ" }, { en: "Battle", ko: "ì „íˆ¬" }, { en: "Beam", ko: "ê´‘ì„ " },
        { en: "Beauty", ko: "ì•„ë¦„ë‹¤ì›€" }, { en: "Believe", ko: "ë¯¿ë‹¤" }, { en: "Benefit", ko: "í˜œíƒ" },
        { en: "Bitter", ko: "ì“´" }, { en: "Blame", ko: "ë¹„ë‚œí•˜ë‹¤" }, { en: "Blank", ko: "ë¹ˆ" },
        { en: "Blast", ko: "í­ë°œ" }, { en: "Blend", ko: "ì„ë‹¤" }, { en: "Bold", ko: "ëŒ€ë‹´í•œ" },
        { en: "Border", ko: "ê²½ê³„" }, { en: "Bored", ko: "ì§€ë£¨í•œ" }, { en: "Borrow", ko: "ë¹Œë¦¬ë‹¤" },
        { en: "Bother", ko: "ê´´ë¡­íˆë‹¤" }, { en: "Bound", ko: "ê²½ê³„" }, { en: "Brave", ko: "ìš©ê°í•œ" },
        { en: "Break", ko: "ê¹¨ë‹¤" }, { en: "Breeze", ko: "ì‚°ë“¤ë°”ëŒ" }, { en: "Brief", ko: "ì§§ì€" },
        { en: "Brilliant", ko: "í›Œë¥­í•œ" }, { en: "Broad", ko: "ë„“ì€" }, { en: "Burst", ko: "í„°ì§€ë‹¤" },
        { en: "Bury", ko: "ë¬»ë‹¤" }, { en: "Calm", ko: "ì°¨ë¶„í•œ" }, { en: "Camp", ko: "ì•¼ì˜í•˜ë‹¤" },
        { en: "Capable", ko: "ìœ ëŠ¥í•œ" }, { en: "Capital", ko: "ìˆ˜ë„" }, { en: "Capture", ko: "í¬íší•˜ë‹¤" },
        { en: "Care", ko: "ëŒë´„" }, { en: "Cast", ko: "ë˜ì§€ë‹¤" }, { en: "Caution", ko: "ì£¼ì˜" },
        { en: "Cease", ko: "ì¤‘ë‹¨í•˜ë‹¤" }, { en: "Certain", ko: "í™•ì‹¤í•œ" }, { en: "Challenge", ko: "ë„ì „" },
        { en: "Chamber", ko: "ë°©" }, { en: "Chance", ko: "ê¸°íšŒ" }, { en: "Change", ko: "ë³€í•˜ë‹¤" },
        { en: "Charge", ko: "ì²­êµ¬í•˜ë‹¤" }, { en: "Charm", ko: "ë§¤ë ¥" }, { en: "Chase", ko: "ë’¤ì«“ë‹¤" },
        { en: "Cheat", ko: "ì†ì´ë‹¤" }, { en: "Cheer", ko: "ì‘ì›í•˜ë‹¤" }, { en: "Cherish", ko: "ì†Œì¤‘íˆ í•˜ë‹¤" },
        { en: "Chew", ko: "ì”¹ë‹¤" }, { en: "Chief", ko: "ìš°ë‘ë¨¸ë¦¬" }, { en: "Chill", ko: "ëƒ‰ê¸°" },
        { en: "Choice", ko: "ì„ íƒ" }, { en: "Choose", ko: "ê³ ë¥´ë‹¤" }, { en: "Chore", ko: "ì§‘ì•ˆì¼" },
        { en: "Circle", ko: "ì›" }, { en: "Citizen", ko: "ì‹œë¯¼" }, { en: "Claim", ko: "ì£¼ì¥í•˜ë‹¤" },
        { en: "Clash", ko: "ì¶©ëŒí•˜ë‹¤" }, { en: "Class", ko: "ìˆ˜ì—…" }, { en: "Claw", ko: "ë°œí†±" },
        { en: "Clear", ko: "ë§‘ì€" }, { en: "Clever", ko: "ì˜ë¦¬í•œ" }, { en: "Climate", ko: "ê¸°í›„" },
        { en: "Cling", ko: "ë§¤ë‹¬ë¦¬ë‹¤" }, { en: "Club", ko: "ë™í˜¸íšŒ" }, { en: "Clue", ko: "ë‹¨ì„œ" },
        { en: "Cluster", ko: "ë¬´ë¦¬" }, { en: "Coast", ko: "í•´ì•ˆ" }, { en: "Coax", ko: "êµ¬ìŠ¬ë¦¬ë‹¤" },
        // --- Group 2 ---
        { en: "Column", ko: "ê¸°ë‘¥" }, { en: "Combat", ko: "ì „íˆ¬" }, { en: "Combine", ko: "ê²°í•©í•˜ë‹¤" },
        { en: "Comfort", ko: "í¸ì•ˆí•¨" }, { en: "Command", ko: "ëª…ë ¹í•˜ë‹¤" }, { en: "Common", ko: "í”í•œ" },
        { en: "Community", ko: "ì§€ì—­ì‚¬íšŒ" }, { en: "Companion", ko: "ë™ë£Œ" }, { en: "Compete", ko: "ê²½ìŸí•˜ë‹¤" },
        { en: "Complain", ko: "ë¶ˆí‰í•˜ë‹¤" }, { en: "Complete", ko: "ì™„ì „í•œ" }, { en: "Complex", ko: "ë³µì¡í•œ" },
        { en: "Compose", ko: "êµ¬ì„±í•˜ë‹¤" }, { en: "Concentrate", ko: "ì§‘ì¤‘í•˜ë‹¤" }, { en: "Concern", ko: "ê±±ì •" },
        { en: "Conclude", ko: "ê²°ë¡ ì§“ë‹¤" }, { en: "Condition", ko: "ìƒíƒœ" }, { en: "Confess", ko: "ìë°±í•˜ë‹¤" },
        { en: "Confide", ko: "ì‹ ë¢°í•˜ë‹¤" }, { en: "Confidence", ko: "ìì‹ ê°" }, { en: "Confuse", ko: "í˜¼ë€ì‹œí‚¤ë‹¤" },
        { en: "Connect", ko: "ì—°ê²°í•˜ë‹¤" }, { en: "Consider", ko: "ê³ ë ¤í•˜ë‹¤" }, { en: "Consist", ko: "êµ¬ì„±ë˜ë‹¤" },
        { en: "Contain", ko: "í¬í•¨í•˜ë‹¤" }, { en: "Content", ko: "ë§Œì¡±í•˜ëŠ”" }, { en: "Contest", ko: "ëŒ€íšŒ" },
        { en: "Continue", ko: "ê³„ì†í•˜ë‹¤" }, { en: "Contract", ko: "ê³„ì•½" }, { en: "Control", ko: "í†µì œí•˜ë‹¤" },
        { en: "Convince", ko: "ì„¤ë“í•˜ë‹¤" }, { en: "Cool", ko: "ì‹œì›í•œ" }, { en: "Copy", ko: "ë³µì‚¬í•˜ë‹¤" },
        { en: "Correct", ko: "ì •í™•í•œ" }, { en: "Cost", ko: "ë¹„ìš©" }, { en: "Cotton", ko: "ì†œ" },
        { en: "Cough", ko: "ê¸°ì¹¨í•˜ë‹¤" }, { en: "Council", ko: "ìœ„ì›íšŒ" }, { en: "Count", ko: "ì„¸ë‹¤" },
        { en: "Country", ko: "ë‚˜ë¼" }, { en: "Couple", ko: "ì»¤í”Œ" }, { en: "Courage", ko: "ìš©ê¸°" },
        { en: "Course", ko: "ê³¼ì •" }, { en: "Court", ko: "ë²•ì›" }, { en: "Cover", ko: "ë®ë‹¤" },
        { en: "Crack", ko: "ê¸ˆ" }, { en: "Crash", ko: "ì¶©ëŒí•˜ë‹¤" }, { en: "Crawl", ko: "ê¸°ì–´ê°€ë‹¤" },
        { en: "Crazy", ko: "ë¯¸ì¹œ" }, { en: "Create", ko: "ì°½ì¡°í•˜ë‹¤" }, { en: "Creature", ko: "ìƒë¬¼" },
        { en: "Credit", ko: "ì‹ ìš©" }, { en: "Creep", ko: "ì‚´ê¸ˆì‚´ê¸ˆ ê±·ë‹¤" }, { en: "Crew", ko: "ìŠ¹ë¬´ì›" },
        { en: "Crime", ko: "ë²”ì£„" }, { en: "Crop", ko: "ë†ì‘ë¬¼" }, { en: "Cross", ko: "ê±´ë„ˆë‹¤" },
        { en: "Crowd", ko: "êµ°ì¤‘" }, { en: "Cruel", ko: "ì”ì¸í•œ" }, { en: "Crush", ko: "ìœ¼ìŠ¤ëŸ¬ëœ¨ë¦¬ë‹¤" },
        { en: "Cry", ko: "ìš¸ë‹¤" }, { en: "Culture", ko: "ë¬¸í™”" }, { en: "Cure", ko: "ì¹˜ë£Œí•˜ë‹¤" },
        { en: "Curious", ko: "í˜¸ê¸°ì‹¬ ë§ì€" }, { en: "Current", ko: "í˜„ì¬ì˜" }, { en: "Custom", ko: "ê´€ìŠµ" },
        { en: "Cycle", ko: "ìˆœí™˜" }, { en: "Damage", ko: "ì†ìƒ" }, { en: "Damp", ko: "ì¶•ì¶•í•œ" },
        { en: "Dance", ko: "ì¶¤ì¶”ë‹¤" }, { en: "Danger", ko: "ìœ„í—˜" }, { en: "Dare", ko: "ê°íˆ ~í•˜ë‹¤" },
        { en: "Dark", ko: "ì–´ë‘ìš´" }, { en: "Dawn", ko: "ìƒˆë²½" }, { en: "Deal", ko: "ë‹¤ë£¨ë‹¤" },
        { en: "Dear", ko: "ì¹œì• í•˜ëŠ”" }, { en: "Decay", ko: "ë¶€íŒ¨í•˜ë‹¤" }, { en: "Deceive", ko: "ì†ì´ë‹¤" },
        { en: "Decide", ko: "ê²°ì •í•˜ë‹¤" }, { en: "Declare", ko: "ì„ ì–¸í•˜ë‹¤" }, { en: "Decrease", ko: "ê°ì†Œí•˜ë‹¤" },
        { en: "Deed", ko: "í–‰ìœ„" }, { en: "Deep", ko: "ê¹Šì€" }, { en: "Defeat", ko: "íŒ¨ë°°ì‹œí‚¤ë‹¤" },
        { en: "Defend", ko: "ë°©ì–´í•˜ë‹¤" }, { en: "Define", ko: "ì •ì˜í•˜ë‹¤" }, { en: "Degree", ko: "ì •ë„" },
        { en: "Delay", ko: "ì§€ì—°ì‹œí‚¤ë‹¤" }, { en: "Delicate", ko: "ì„¬ì„¸í•œ" }, { en: "Delight", ko: "ê¸°ì¨" },
        { en: "Deliver", ko: "ë°°ë‹¬í•˜ë‹¤" }, { en: "Demand", ko: "ìš”êµ¬í•˜ë‹¤" }, { en: "Deny", ko: "ë¶€ì¸í•˜ë‹¤" },
        { en: "Depart", ko: "ì¶œë°œí•˜ë‹¤" }, { en: "Depend", ko: "ì˜ì¡´í•˜ë‹¤" }, { en: "Describe", ko: "ë¬˜ì‚¬í•˜ë‹¤" },
        { en: "Desert", ko: "ì‚¬ë§‰" }, { en: "Design", ko: "ì„¤ê³„í•˜ë‹¤" }, { en: "Desire", ko: "ìš•ë§" },
        // --- Group 3 ---
        { en: "Destroy", ko: "íŒŒê´´í•˜ë‹¤" }, { en: "Detail", ko: "ì„¸ë¶€ì‚¬í•­" }, { en: "Detect", ko: "íƒì§€í•˜ë‹¤" },
        { en: "Develop", ko: "ë°œì „ì‹œí‚¤ë‹¤" }, { en: "Device", ko: "ì¥ì¹˜" }, { en: "Devote", ko: "í—Œì‹ í•˜ë‹¤" },
        { en: "Diagram", ko: "ë„í‘œ" }, { en: "Dial", ko: "ë‹¤ì´ì–¼" }, { en: "Dialogue", ko: "ëŒ€í™”" },
        { en: "Dictate", ko: "ì§€ì‹œí•˜ë‹¤" }, { en: "Diet", ko: "ì‹ë‹¨" }, { en: "Differ", ko: "ë‹¤ë¥´ë‹¤" },
        { en: "Digest", ko: "ì†Œí™”í•˜ë‹¤" }, { en: "Dim", ko: "íë¦¿í•œ" }, { en: "Direct", ko: "ì§ì ‘ì ì¸" },
        { en: "Direction", ko: "ë°©í–¥" }, { en: "Dirt", ko: "ë¨¼ì§€" }, { en: "Disaster", ko: "ì¬ì•™" },
        { en: "Discover", ko: "ë°œê²¬í•˜ë‹¤" }, { en: "Discuss", ko: "í† ë¡ í•˜ë‹¤" }, { en: "Disease", ko: "ì§ˆë³‘" },
        { en: "Disgust", ko: "í˜ì˜¤ê°" }, { en: "Display", ko: "ì „ì‹œí•˜ë‹¤" }, { en: "Distance", ko: "ê±°ë¦¬" },
        { en: "Distinct", ko: "ëšœë ·í•œ" }, { en: "Distract", ko: "ì‚°ë§Œí•˜ê²Œ í•˜ë‹¤" }, { en: "Disturb", ko: "ë°©í•´í•˜ë‹¤" },
        { en: "Divide", ko: "ë‚˜ëˆ„ë‹¤" }, { en: "Doubt", ko: "ì˜ì‹¬í•˜ë‹¤" }, { en: "Doze", ko: "ì¡¸ë‹¤" },
        { en: "Drag", ko: "ëŒë‹¤" }, { en: "Drain", ko: "ë°°ìˆ˜í•˜ë‹¤" }, { en: "Drama", ko: "ë“œë¼ë§ˆ" },
        { en: "Draw", ko: "ê·¸ë¦¬ë‹¤" }, { en: "Dread", ko: "ë‘ë ¤ì›Œí•˜ë‹¤" }, { en: "Dream", ko: "ê¿ˆ" },
        { en: "Dress", ko: "ì˜·ì„ ì…ë‹¤" }, { en: "Drift", ko: "í‘œë¥˜í•˜ë‹¤" }, { en: "Drill", ko: "í›ˆë ¨" },
        { en: "Drive", ko: "ìš´ì „í•˜ë‹¤" }, { en: "Drop", ko: "ë–¨ì–´ëœ¨ë¦¬ë‹¤" }, { en: "Drown", ko: "ìµì‚¬í•˜ë‹¤" },
        { en: "Drowsy", ko: "ì¡¸ë¦¬ëŠ”" }, { en: "Due", ko: "ì˜ˆì •ì¸" }, { en: "Dull", ko: "ì§€ë£¨í•œ" },
        { en: "Dumb", ko: "ì–´ë¦¬ì„ì€" }, { en: "Dust", ko: "ë¨¼ì§€" }, { en: "Duty", ko: "ì˜ë¬´" },
        { en: "Eager", ko: "ì—´ë§í•˜ëŠ”" }, { en: "Earn", ko: "ë²Œë‹¤" }, { en: "Earth", ko: "ì§€êµ¬" },
        { en: "Ease", ko: "ì‰¬ì›€" }, { en: "Edge", ko: "ê°€ì¥ìë¦¬" }, { en: "Educate", ko: "êµìœ¡í•˜ë‹¤" },
        { en: "Effect", ko: "íš¨ê³¼" }, { en: "Effort", ko: "ë…¸ë ¥" }, { en: "Elder", ko: "ì†ìœ—ì‚¬ëŒ" },
        { en: "Elect", ko: "ì„ ì¶œí•˜ë‹¤" }, { en: "Elegant", ko: "ìš°ì•„í•œ" }, { en: "Element", ko: "ìš”ì†Œ" },
        { en: "Eliminate", ko: "ì œê±°í•˜ë‹¤" }, { en: "Emergency", ko: "ë¹„ìƒì‚¬íƒœ" }, { en: "Emotion", ko: "ê°ì •" },
        { en: "Employ", ko: "ê³ ìš©í•˜ë‹¤" }, { en: "Empty", ko: "ë¹ˆ" }, { en: "Enable", ko: "ê°€ëŠ¥í•˜ê²Œ í•˜ë‹¤" },
        { en: "Encourage", ko: "ê²©ë ¤í•˜ë‹¤" }, { en: "Endure", ko: "ê²¬ë””ë‹¤" }, { en: "Enemy", ko: "ì " },
        { en: "Energy", ko: "ì—ë„ˆì§€" }, { en: "Engage", ko: "ê´€ì—¬í•˜ë‹¤" }, { en: "Engine", ko: "ì—”ì§„" },
        { en: "Enjoy", ko: "ì¦ê¸°ë‹¤" }, { en: "Enormous", ko: "ê±°ëŒ€í•œ" }, { en: "Enough", ko: "ì¶©ë¶„í•œ" },
        { en: "Enter", ko: "ë“¤ì–´ê°€ë‹¤" }, { en: "Entertain", ko: "ì¦ê²ê²Œ í•˜ë‹¤" }, { en: "Entire", ko: "ì „ì²´ì˜" },
        { en: "Entrance", ko: "ì…êµ¬" }, { en: "Envy", ko: "ë¶€ëŸ¬ì›Œí•˜ë‹¤" }, { en: "Equal", ko: "ë™ë“±í•œ" },
        { en: "Equip", ko: "ì¥ë¹„ë¥¼ ê°–ì¶”ë‹¤" }, { en: "Escape", ko: "íƒˆì¶œí•˜ë‹¤" }, { en: "Especially", ko: "íŠ¹íˆ" },
        { en: "Essay", ko: "ìˆ˜í•„" }, { en: "Essential", ko: "í•„ìˆ˜ì ì¸" }, { en: "Establish", ko: "ì„¤ë¦½í•˜ë‹¤" },
        { en: "Estimate", ko: "ì¶”ì •í•˜ë‹¤" }, { en: "Eternal", ko: "ì˜ì›í•œ" }, { en: "Event", ko: "ì‚¬ê±´" },
        { en: "Evidence", ko: "ì¦ê±°" }, { en: "Evil", ko: "ì•…í•œ" }, { en: "Exact", ko: "ì •í™•í•œ" },
        { en: "Examine", ko: "ê²€ì‚¬í•˜ë‹¤" }, { en: "Example", ko: "ì˜ˆì‹œ" }, { en: "Excellent", ko: "í›Œë¥­í•œ" },
        { en: "Except", ko: "ì œì™¸í•˜ê³ " }, { en: "Exchange", ko: "êµí™˜í•˜ë‹¤" }, { en: "Excite", ko: "í¥ë¶„ì‹œí‚¤ë‹¤" },
        // --- Group 4 ---
        { en: "Exclude", ko: "ë°°ì œí•˜ë‹¤" }, { en: "Excuse", ko: "ë³€ëª…" }, { en: "Exercise", ko: "ìš´ë™" },
        { en: "Exhaust", ko: "ì§€ì¹˜ê²Œ í•˜ë‹¤" }, { en: "Exhibit", ko: "ì „ì‹œí•˜ë‹¤" }, { en: "Exist", ko: "ì¡´ì¬í•˜ë‹¤" },
        { en: "Expand", ko: "í™•ì¥í•˜ë‹¤" }, { en: "Expect", ko: "ê¸°ëŒ€í•˜ë‹¤" }, { en: "Expense", ko: "ë¹„ìš©" },
        { en: "Experience", ko: "ê²½í—˜" }, { en: "Experiment", ko: "ì‹¤í—˜" }, { en: "Expert", ko: "ì „ë¬¸ê°€" },
        { en: "Explain", ko: "ì„¤ëª…í•˜ë‹¤" }, { en: "Explode", ko: "í­ë°œí•˜ë‹¤" }, { en: "Explore", ko: "íƒí—˜í•˜ë‹¤" },
        { en: "Export", ko: "ìˆ˜ì¶œí•˜ë‹¤" }, { en: "Expose", ko: "ë…¸ì¶œí•˜ë‹¤" }, { en: "Express", ko: "í‘œí˜„í•˜ë‹¤" },
        { en: "Extend", ko: "ì—°ì¥í•˜ë‹¤" }, { en: "Extent", ko: "ì •ë„" }, { en: "Extra", ko: "ì¶”ê°€ì˜" },
        { en: "Extreme", ko: "ê·¹ë„ì˜" }, { en: "Fable", ko: "ìš°í™”" }, { en: "Face", ko: "ì§ë©´í•˜ë‹¤" },
        { en: "Fact", ko: "ì‚¬ì‹¤" }, { en: "Factor", ko: "ìš”ì¸" }, { en: "Factory", ko: "ê³µì¥" },
        { en: "Fade", ko: "í¬ë¯¸í•´ì§€ë‹¤" }, { en: "Fail", ko: "ì‹¤íŒ¨í•˜ë‹¤" }, { en: "Faint", ko: "í¬ë¯¸í•œ" },
        { en: "Fair", ko: "ê³µì •í•œ" }, { en: "Faith", ko: "ì‹ ë…" }, { en: "False", ko: "ê±°ì§“ì˜" },
        { en: "Fame", ko: "ëª…ì„±" }, { en: "Familiar", ko: "ì¹œìˆ™í•œ" }, { en: "Family", ko: "ê°€ì¡±" },
        { en: "Famine", ko: "ê¸°ê·¼" }, { en: "Famous", ko: "ìœ ëª…í•œ" }, { en: "Fancy", ko: "í™”ë ¤í•œ" },
        { en: "Far", ko: "ë©€ë¦¬" }, { en: "Fare", ko: "ìš”ê¸ˆ" }, { en: "Farm", ko: "ë†ì¥" },
        { en: "Fascinate", ko: "ë§¤í˜¹í•˜ë‹¤" }, { en: "Fashion", ko: "ìœ í–‰" }, { en: "Fast", ko: "ë¹ ë¥¸" },
        { en: "Fasten", ko: "ë§¤ë‹¤" }, { en: "Fat", ko: "ì§€ë°©" }, { en: "Fatal", ko: "ì¹˜ëª…ì ì¸" },
        { en: "Fate", ko: "ìš´ëª…" }, { en: "Father", ko: "ì•„ë²„ì§€" }, { en: "Fault", ko: "ê²°ì " },
        { en: "Favor", ko: "í˜¸ì˜" }, { en: "Fear", ko: "ë‘ë ¤ì›€" }, { en: "Feast", ko: "ì¶•ì œ" },
        { en: "Feather", ko: "ê¹ƒí„¸" }, { en: "Feature", ko: "íŠ¹ì§•" }, { en: "Federal", ko: "ì—°ë°©ì˜" },
        { en: "Fee", ko: "ìš”ê¸ˆ" }, { en: "Feed", ko: "ë¨¹ì´ë‹¤" }, { en: "Feel", ko: "ëŠë¼ë‹¤" },
        { en: "Fellow", ko: "ë™ë£Œ" }, { en: "Female", ko: "ì—¬ì„±ì˜" }, { en: "Fence", ko: "ìš¸íƒ€ë¦¬" },
        { en: "Fertile", ko: "ë¹„ì˜¥í•œ" }, { en: "Festival", ko: "ì¶•ì œ" }, { en: "Fetch", ko: "ê°€ì ¸ì˜¤ë‹¤" },
        { en: "Fever", ko: "ì—´" }, { en: "Few", ko: "ì†Œìˆ˜ì˜" }, { en: "Fiction", ko: "ì†Œì„¤" },
        { en: "Field", ko: "ë“¤íŒ" }, { en: "Fierce", ko: "ì‚¬ë‚˜ìš´" }, { en: "Fight", ko: "ì‹¸ìš°ë‹¤" },
        { en: "Figure", ko: "ìˆ˜ì¹˜" }, { en: "File", ko: "íŒŒì¼" }, { en: "Fill", ko: "ì±„ìš°ë‹¤" },
        { en: "Film", ko: "ì˜í™”" }, { en: "Final", ko: "ë§ˆì§€ë§‰ì˜" }, { en: "Finance", ko: "ì¬ì •" },
        { en: "Find", ko: "ì°¾ë‹¤" }, { en: "Fine", ko: "ì¢‹ì€" }, { en: "Finger", ko: "ì†ê°€ë½" },
        { en: "Finish", ko: "ëë‚´ë‹¤" }, { en: "Fire", ko: "ë¶ˆ" }, { en: "Firm", ko: "ë‹¨ë‹¨í•œ" },
        { en: "First", ko: "ì²« ë²ˆì§¸ì˜" }, { en: "Fish", ko: "ë¬¼ê³ ê¸°" }, { en: "Fit", ko: "ë§ë‹¤" },
        { en: "Fix", ko: "ê³ ì¹˜ë‹¤" }, { en: "Flag", ko: "ê¹ƒë°œ" }, { en: "Flame", ko: "ë¶ˆê½ƒ" },
        { en: "Flash", ko: "ë²ˆì©ì´ë‹¤" }, { en: "Flat", ko: "í‰í‰í•œ" }, { en: "Flavor", ko: "ë§›" },
        { en: "Flee", ko: "ë‹¬ì•„ë‚˜ë‹¤" }, { en: "Fleet", ko: "í•¨ëŒ€" }, { en: "Flesh", ko: "ì‚´" },
        { en: "Flexible", ko: "ìœ ì—°í•œ" }, { en: "Flight", ko: "ë¹„í–‰" }, { en: "Float", ko: "ëœ¨ë‹¤" },
        // --- Group 5 ---
        { en: "Flock", ko: "ë¬´ë¦¬" }, { en: "Flood", ko: "í™ìˆ˜" }, { en: "Floor", ko: "ë°”ë‹¥" },
        { en: "Flour", ko: "ë°€ê°€ë£¨" }, { en: "Flow", ko: "íë¥´ë‹¤" }, { en: "Flower", ko: "ê½ƒ" },
        { en: "Fluent", ko: "ìœ ì°½í•œ" }, { en: "Fluid", ko: "ì•¡ì²´" }, { en: "Fly", ko: "ë‚ ë‹¤" },
        { en: "Focus", ko: "ì§‘ì¤‘í•˜ë‹¤" }, { en: "Fog", ko: "ì•ˆê°œ" }, { en: "Fold", ko: "ì ‘ë‹¤" },
        { en: "Folk", ko: "ì‚¬ëŒë“¤" }, { en: "Follow", ko: "ë”°ë¥´ë‹¤" }, { en: "Fond", ko: "ì¢‹ì•„í•˜ëŠ”" },
        { en: "Food", ko: "ìŒì‹" }, { en: "Fool", ko: "ë°”ë³´" }, { en: "Foot", ko: "ë°œ" },
        { en: "Forbid", ko: "ê¸ˆì§€í•˜ë‹¤" }, { en: "Force", ko: "í˜" }, { en: "Forecast", ko: "ì˜ˆë³´í•˜ë‹¤" },
        { en: "Foreign", ko: "ì™¸êµ­ì˜" }, { en: "Forest", ko: "ìˆ²" }, { en: "Forever", ko: "ì˜ì›íˆ" },
        { en: "Forget", ko: "ìŠë‹¤" }, { en: "Forgive", ko: "ìš©ì„œí•˜ë‹¤" }, { en: "Fork", ko: "í¬í¬" },
        { en: "Form", ko: "í˜•íƒœ" }, { en: "Formal", ko: "ê²©ì‹ì„ ì°¨ë¦°" }, { en: "Former", ko: "ì´ì „ì˜" },
        { en: "Fort", ko: "ìš”ìƒˆ" }, { en: "Fortunate", ko: "ìš´ì´ ì¢‹ì€" }, { en: "Fortune", ko: "ìš´" },
        { en: "Forward", ko: "ì•ìœ¼ë¡œ" }, { en: "Found", ko: "ì„¤ë¦½í•˜ë‹¤" }, { en: "Foundation", ko: "ê¸°ì´ˆ" },
        { en: "Fountain", ko: "ë¶„ìˆ˜" }, { en: "Fragile", ko: "ê¹¨ì§€ê¸° ì‰¬ìš´" }, { en: "Frame", ko: "í‹€" },
        { en: "Free", ko: "ììœ ë¡œìš´" }, { en: "Freeze", ko: "ì–¼ë‹¤" }, { en: "Frequent", ko: "ë¹ˆë²ˆí•œ" },
        { en: "Fresh", ko: "ì‹ ì„ í•œ" }, { en: "Friend", ko: "ì¹œêµ¬" }, { en: "Fright", ko: "ê³µí¬" },
        { en: "Front", ko: "ì•" }, { en: "Frontier", ko: "êµ­ê²½" }, { en: "Frost", ko: "ì„œë¦¬" },
        { en: "Frown", ko: "ì°Œí‘¸ë¦¬ë‹¤" }, { en: "Fruit", ko: "ê³¼ì¼" }, { en: "Frustrate", ko: "ì¢Œì ˆì‹œí‚¤ë‹¤" },
        { en: "Fry", ko: "íŠ€ê¸°ë‹¤" }, { en: "Fuel", ko: "ì—°ë£Œ" }, { en: "Fulfill", ko: "ì„±ì·¨í•˜ë‹¤" },
        { en: "Full", ko: "ê°€ë“ ì°¬" }, { en: "Fun", ko: "ì¬ë¯¸" }, { en: "Function", ko: "ê¸°ëŠ¥" },
        { en: "Fund", ko: "ìê¸ˆ" }, { en: "Fundamental", ko: "ê·¼ë³¸ì ì¸" }, { en: "Funeral", ko: "ì¥ë¡€ì‹" },
        { en: "Funny", ko: "ì›ƒê¸°ëŠ”" }, { en: "Fur", ko: "í„¸" }, { en: "Furnish", ko: "ê°€êµ¬ë¥¼ ë¹„ì¹˜í•˜ë‹¤" },
        { en: "Furniture", ko: "ê°€êµ¬" }, { en: "Further", ko: "ê·¸ ì´ìƒì˜" }, { en: "Future", ko: "ë¯¸ë˜" },
        { en: "Gain", ko: "ì–»ë‹¤" }, { en: "Gallery", ko: "ê°¤ëŸ¬ë¦¬" }, { en: "Game", ko: "ê²Œì„" },
        { en: "Gap", ko: "ê²©ì°¨" }, { en: "Garage", ko: "ì°¨ê³ " }, { en: "Garbage", ko: "ì“°ë ˆê¸°" },
        { en: "Garden", ko: "ì •ì›" }, { en: "Gas", ko: "ê°€ìŠ¤" }, { en: "Gate", ko: "ë¬¸" },
        { en: "Gather", ko: "ëª¨ìœ¼ë‹¤" }, { en: "Gaze", ko: "ì‘ì‹œí•˜ë‹¤" }, { en: "Gear", ko: "ì¥ë¹„" },
        { en: "General", ko: "ì¼ë°˜ì ì¸" }, { en: "Generate", ko: "ë°œìƒì‹œí‚¤ë‹¤" }, { en: "Generation", ko: "ì„¸ëŒ€" },
        { en: "Generous", ko: "ê´€ëŒ€í•œ" }, { en: "Gentle", ko: "ì˜¨í™”í•œ" }, { en: "Genuine", ko: "ì§„ì§œì˜" },
        { en: "Geography", ko: "ì§€ë¦¬" }, { en: "Gesture", ko: "ëª¸ì§“" }, { en: "Ghost", ko: "ìœ ë ¹" },
        { en: "Giant", ko: "ê±°ëŒ€í•œ" }, { en: "Gift", ko: "ì„ ë¬¼" }, { en: "Girl", ko: "ì†Œë…€" },
        { en: "Give", ko: "ì£¼ë‹¤" }, { en: "Glad", ko: "ê¸°ìœ" }, { en: "Glance", ko: "íë— ë³´ë‹¤" },
        { en: "Glass", ko: "ìœ ë¦¬" }, { en: "Glide", ko: "ë¯¸ë„ëŸ¬ì§€ë‹¤" }, { en: "Glimpse", ko: "ì–¸ëœ» ë´„" },
        { en: "Global", ko: "ì„¸ê³„ì ì¸" }, { en: "Globe", ko: "ì§€êµ¬ë³¸" }, { en: "Glory", ko: "ì˜ê´‘" },
        { en: "Glove", ko: "ì¥ê°‘" }
    ];
    // ** ì£¼ì˜: ê°€ì§œ ë°ì´í„° ë£¨í”„(for i=31...)ëŠ” ì™„ì „íˆ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.

    // --- 3. Configuration ---
    const WORDS_PER_GROUP = 100;
    const STAGES_PER_GROUP = 5;
    const MAX_STAGES = 25; // 25ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ì‹œ ì—”ë”©
    const monsters = ['ğŸ‘¾', 'ğŸ‘¹', 'ğŸ¤–', 'ğŸ¦–', 'ğŸ‘»', 'ğŸ™', 'ğŸ§Ÿ', 'ğŸ§›', 'ğŸ‰', 'ğŸ‘½'];

    // --- 4. Game Logic ---
    let currentScore = 0;
    let currentStage = 1;
    let playerMaxHP = 5;
    let playerHP = 5;
    let monsterMaxHP = 3; 
    let monsterHP = 3;
    let currentWordObj = null;
    let wrongAnswers = []; // ì˜¤ë‹µ ì €ì¥ìš© ë°°ì—´
    
    function startGame() {
        document.getElementById('start-modal').style.display = 'none';
        initAudio();
        resetGame();
    }
    
    // íƒ€ì´í‹€(ì²« í™”ë©´)ë¡œ ëŒì•„ê°€ê¸°
    function goToTitle() {
        document.getElementById('game-modal').style.display = 'none';
        document.getElementById('start-modal').style.display = 'flex';
        // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”ëŠ” startGameì—ì„œ ìˆ˜í–‰ë¨
    }

    function resetGame() {
        currentScore = 0;
        currentStage = 1;
        playerHP = playerMaxHP;
        monsterMaxHP = 3; 
        wrongAnswers = []; // ì˜¤ë‹µ ê¸°ë¡ ì´ˆê¸°í™”
        
        document.getElementById('game-modal').style.display = 'none';
        spawnNewMonster();
        loadNextQuestion();
        updateStats();
    }

    function getCurrentGroupIndex() {
        let index = Math.floor((currentStage - 1) / STAGES_PER_GROUP);
        if (index > 4) index = 4;
        return index;
    }

    function spawnNewMonster() {
        monsterHP = monsterMaxHP;
        const randomMonster = monsters[Math.floor(Math.random() * monsters.length)];
        document.getElementById('monster').innerText = randomMonster;
        updateStats();
    }

    function loadNextQuestion() {
        const groupIndex = getCurrentGroupIndex();
        
        const startIndex = groupIndex * WORDS_PER_GROUP;
        // ë°°ì—´ ê¸¸ì´ë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ì•ˆì „ì¥ì¹˜
        const endIndex = Math.min(startIndex + WORDS_PER_GROUP, wordDatabase.length);
        const currentPool = wordDatabase.slice(startIndex, endIndex);

        const randomPoolIndex = Math.floor(Math.random() * currentPool.length);
        currentWordObj = currentPool[randomPoolIndex];

        document.getElementById('word-display').innerText = currentWordObj.en;
        document.getElementById('group-badge').innerText = `Group ${groupIndex + 1}`;
        document.getElementById('stage-info').innerText = `Words No. ${startIndex + 1} ~ ${endIndex}`;

        let options = [currentWordObj.ko];
        while (options.length < 3) {
            const randomWrong = currentPool[Math.floor(Math.random() * currentPool.length)].ko;
            if (!options.includes(randomWrong)) options.push(randomWrong);
        }
        options.sort(() => Math.random() - 0.5);

        const container = document.getElementById('options-container');
        container.innerHTML = '';
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = function() { checkAnswer(opt, this); };
            container.appendChild(btn);
        });
    }

    function checkAnswer(selectedMeaning, clickedBtn) {
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(btn => btn.disabled = true);

        let delay = 1000;

        if (selectedMeaning === currentWordObj.ko) {
            // [ì •ë‹µ]
            clickedBtn.classList.add('btn-correct');
            playWinSound();
            currentScore += 10;
            monsterHP--;
            animateAttack('player');
        } else {
            // [ì˜¤ë‹µ]
            clickedBtn.classList.add('btn-wrong');
            playLoseSound();
            playerHP--;
            
            // ì˜¤ë‹µ ë…¸íŠ¸ì— ê¸°ë¡ (ì¤‘ë³µ ë°©ì§€)
            const alreadyExists = wrongAnswers.some(w => w.en === currentWordObj.en);
            if (!alreadyExists) {
                wrongAnswers.push(currentWordObj);
            }

            animateAttack('monster');
            
            allBtns.forEach(btn => {
                if(btn.innerText === currentWordObj.ko) btn.classList.add('btn-correct');
            });
            delay = 1500;
        }

        updateStats();

        setTimeout(() => {
            if (playerHP <= 0) {
                endGame(false); // íŒ¨ë°°
            } else if (monsterHP <= 0) {
                handleStageClear();
            } else {
                loadNextQuestion();
            }
        }, delay);
    }

    function handleStageClear() {
        // ìŠ¤í…Œì´ì§€ 25ë¥¼ í´ë¦¬ì–´í–ˆë‹¤ë©´ ê²Œì„ ì—”ë”©
        if (currentStage >= MAX_STAGES) {
            endGame(true); // ìŠ¹ë¦¬
            return;
        }

        const oldGroup = getCurrentGroupIndex();
        currentStage++;
        const newGroup = getCurrentGroupIndex();

        monsterMaxHP++; 
        spawnNewMonster();

        if (newGroup > oldGroup) {
            const noti = document.getElementById('group-notification');
            noti.style.display = 'block';
            setTimeout(() => {
                noti.style.display = 'none';
                loadNextQuestion();
            }, 2000);
        } else {
            loadNextQuestion();
        }
    }

    function animateAttack(attacker) {
        const attackerElem = document.getElementById(attacker);
        const defenderElem = document.getElementById(attacker === 'player' ? 'monster' : 'player');
        
        attackerElem.style.transform = attacker === 'player' ? 'translateX(20px)' : 'translateX(-20px)';
        setTimeout(() => attackerElem.style.transform = 'translate(0)', 200);

        defenderElem.classList.add('shake', 'hit');
        setTimeout(() => defenderElem.classList.remove('shake', 'hit'), 500);
    }

    function updateStats() {
        document.getElementById('score').innerText = currentScore;
        document.getElementById('stage').innerText = currentStage;
        document.getElementById('player-hp-bar').style.width = (playerHP / playerMaxHP * 100) + '%';
        document.getElementById('monster-hp-bar').style.width = (monsterHP / monsterMaxHP * 100) + '%';
    }

    // isClear: true(í´ë¦¬ì–´), false(ê²Œì„ì˜¤ë²„)
    function endGame(isClear) {
        const titleElem = document.getElementById('modal-title');
        const scoreElem = document.getElementById('modal-score');
        const modal = document.getElementById('game-modal');
        const listContainer = document.getElementById('wrong-answers-list');

        // 1. íƒ€ì´í‹€ ë° ë©”ì‹œì§€ ì„¤ì •
        if (isClear) {
            titleElem.innerText = "ğŸ‰ Mission Complete! ğŸ‰";
            titleElem.style.color = "#2ecc71";
            scoreElem.innerText = `Great Job! Final Score: ${currentScore}`;
        } else {
            titleElem.innerText = "Game Over ğŸ’€";
            titleElem.style.color = "#333";
            scoreElem.innerText = `Final Score: ${currentScore}`;
        }

        // 2. ì˜¤ë‹µ ë…¸íŠ¸ ìƒì„±
        listContainer.innerHTML = ''; // ì´ˆê¸°í™”
        if (wrongAnswers.length === 0) {
            listContainer.innerHTML = '<div style="padding:10px; color:#2ecc71; text-align:center;">í‹€ë¦° ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤! ì™„ë²½í•´ìš”! ğŸ‘</div>';
        } else {
            wrongAnswers.forEach(word => {
                const item = document.createElement('div');
                item.className = 'wrong-item';
                item.innerHTML = `<span class="wrong-en">${word.en}</span><span class="wrong-ko">${word.ko}</span>`;
                listContainer.appendChild(item);
            });
        }

        // 3. ëª¨ë‹¬ í‘œì‹œ
        modal.style.display = 'flex';
    }
</script>

</body>
</html>